# mofa-pptx

Generate presentation decks as full-bleed AI-rendered slide images, assembled into PPTX. Each slide is a single high-resolution PNG generated by Gemini, composed from a **style prefix** (visual system) + **slide prompt** (content/layout).

```
Style Module (getStyle)  +  Slide Prompt (per-slide content)
             ↓
       Gemini 3 Pro Image Preview API
             ↓
       PNG images (cached in slides-{deck}/)
             ↓
       PptxGenJS assembly → .pptx
```

## Setup

```bash
npm install
export GEMINI_API_KEY="your-api-key"
```

## Quick Start

### 1. Pick or create a style module

Style modules live in `styles/` and define the visual system — background, typography, illustration style. Each exports a `getStyle(tag)` function that maps style tags to prompt prefixes.

```javascript
// styles/my-style.js
const STYLE_NORMAL = `Create a presentation slide image. 1920x1080 pixels, 16:9 landscape format.

BACKGROUND: Deep navy (#1A1F36), clean, premium.
TYPOGRAPHY: Noto Sans SC for ALL text. ALL text in Chinese ONLY.
- Title: bold, white, large heading
- Body: light weight, light gray, standard body size

ILLUSTRATION STYLE (CRITICAL):
Monochrome wireframe sketches in white/light gray line art on dark background.
Hand-drawn quality but clean and readable. Apple Keynote level whitespace.`;

const STYLE_COVER = `Create a presentation slide image. 1920x1080 pixels, 16:9 landscape format.

BACKGROUND: Dark gradient from #0A0F28 to #1A1F36.
TYPOGRAPHY: Noto Sans SC, bold, white, extra-large heading. ONLY the main title, nothing else.`;

const styles = { normal: STYLE_NORMAL, cover: STYLE_COVER };
function getStyle(tag) { return styles[tag] || styles.normal; }
module.exports = { styles, getStyle, STYLE_NORMAL, STYLE_COVER };
```

### 2. Write a deck script

Deck scripts define the slides array and call `run()`.

```javascript
// generate-my-deck.js
const { run } = require("./lib/engine");
const { getStyle } = require("./styles/my-style");

const slides = [
  {
    style: "cover",
    prompt: `TITLE: "My Presentation Title"
Centered vertically in the left 60% of the slide. Nothing else.`,
  },
  {
    style: "normal",
    prompt: `TITLE (top-left, bold, white): "Key Findings"

LAYOUT: 3 cards in a row, each with:
- Icon: wireframe sketch (chart, gear, rocket)
- Heading: bold, white, 20pt
- Body: light gray, 16pt

CARD 1: "Revenue Growth" / "+47% year over year"
CARD 2: "Efficiency" / "3x faster deployment cycles"
CARD 3: "Scale" / "Supporting 10M+ daily users"`,
  },
];

run({
  slideDir: "slides-my-deck",
  outFile: "My_Presentation.pptx",
  slides,
  getStyle,
  concurrency: 5,
  imageSize: "2K",
});
```

### 3. Generate

```bash
node generate-my-deck.js
```

Output: `My_Presentation.pptx` with cached PNGs in `slides-my-deck/`.

## Engine API

```javascript
const { run } = require("./lib/engine");

run({
  slideDir: "slides-my-deck",       // PNG cache directory
  outFile: "Output.pptx",           // Output PPTX filename
  slides: [                         // Array of { style, prompt }
    { style: "cover", prompt: "..." },
    { style: "normal", prompt: "..." },
  ],
  getStyle: (tag) => styleString,   // Style resolver from styles/*.js
  concurrency: 5,                   // Parallel workers (1-20)
  imageSize: "2K",                  // "1K" | "2K" | "4K" (optional)
});
```

### Resolution

| imageSize | Resolution | Use |
|-----------|-----------|-----|
| `"1K"` | 1376 x 768 | Quick drafts |
| `"2K"` | 2752 x 1536 | Standard decks (recommended) |
| `"4K"` | 5504 x 3072 | Print quality |

Resolution in prompt text is ignored by Gemini — must use the `imageSize` parameter.

### PNG Caching

Generated PNGs are cached (skip if file >10KB exists). To fix a bad slide:

```bash
rm slides-my-deck/slide-05.png   # delete the bad one
node generate-my-deck.js          # only slide 5 regenerates
```

Full regeneration: `rm slides-my-deck/*.png && node generate-my-deck.js`

### Concurrency

| Setting | Behavior |
|---------|----------|
| `1` | Sequential, one slide at a time |
| `5` | Safe default for most Gemini rate limits |
| `10-20` | Faster, works if your API quota allows |

## Included Styles

| Module | Tags | Theme |
|--------|------|-------|
| `tectonic.js` | normal, data, cover | Lavender gradient, whale watermark, monochrome wireframe |
| `opensource.js` | normal, data, cover | Similar to tectonic, cartoon whale variant |
| `infra-race.js` | cover, amazon_dark, amazon_light, google, microsoft, nvidia_dark, nvidia_light, overview | Multi-company branded wireframes |
| `feng-zikai.js` | scene, content, emotion | Feng Zikai ink-wash painting on rice paper |
| `dark-community.js` | default | Linux Foundation corporate, abstract AI orbs |
| `agentic-enterprise.js` | normal, cover, data, warm | Purple consulting deck |
| `agentic-enterprise-huawei.js` | normal, cover, data | Huawei Red branded |
| `tea-camp.js` | cover, day1, day2, day3, info | Lingnan ink-wash painting |
| `what-is-life.js` | cover, physics_dark, biology_light, overview | Science-themed |
| `openclaw-huawei.js` | normal, cover, data | Huawei-branded 4K |
| `huawei-linaro.js` | normal | Huawei red corporate |
| `nb-pro.js` | default | Lavender gradient purple accent |
| `nb-br.js` | default | Blade Runner 2049 dark cinematic |
| `cc-research.js` | default | Blade Runner 2049 golden hour warm |

## Prompting Tips

**Style prefixes** should specify: resolution/format, background colors, typography (fonts, weights, sizes, colors), illustration style (the most important part), and overall aesthetic reference.

**Slide prompts** should describe: title (position, style), layout (cards, columns, grids), per-element details (diagrams, text content), and optionally page numbers.

Use visual separators for complex layouts:
```
═══════════════════════════════════════
─── CARD 1: "Title" ───
─── CARD 2: "Title" ───
```

**Common pitfalls:**
- Gemini may garble Chinese text — always visually inspect output
- Avoid `"title (12pt, #888)"` — Gemini renders formatting hints as literal text. Use natural language: `"title in small gray text"`
- For Chinese-only decks, explicitly state `"ALL TEXT IN CHINESE"` and `"English only for proper nouns"`
- Complex multi-card layouts may need 2-3 regeneration attempts
